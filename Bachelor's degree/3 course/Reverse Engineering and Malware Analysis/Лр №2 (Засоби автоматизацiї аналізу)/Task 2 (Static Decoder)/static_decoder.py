import os
from pwn import *

hex_file = open("payload.bin")
hex_file.seek(0, os.SEEK_END)
payload_size = hex_file.tell()
sc_size = payload_size - 16
hex_file.close()

hex_file = read("payload.bin")
start_position = hex_file.find(b"\xE2\xFA") + 2

decryp = list()
encryp = list()
key = list()

for s in range(1, sc_size + 1):
    encryp.append(hex_file[start_position + s - 1])
    key.append(s)

for s in range(0, sc_size):
    decryp.append(int.from_bytes(xor(encryp[s], key[s]), 'little'))

for c in decryp:
    print(chr(c), end='')
